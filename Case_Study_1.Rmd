---
title: "Case_Study_1"
author: "Charles Henderson"
date: "10/10/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)


##Load Beers and Breweries data. 
library(readr)
library(tables)
library(dplyr)
library(plyr)
library(ggplot2)
library(RColorBrewer)
library(psych)

Beers <- read_csv("Beers.csv")
Breweries <- read_csv("Breweries.csv")
Breweries2 <- rename(Breweries, c("Brew_ID" = "Brewery_id", "Name" = "Brewery_Name"))


##How many breweries in each state?
Breweries_Per_State <- table(Breweries$State)
Breweries_Per_State

##Beer Data merged with Breweries Data.
Beer_Merge <- as.data.frame(merge(Beers, Breweries2, all = TRUE))
head(Beer_Merge, n= 6)
tail(Beer_Merge, n= 6)

##Reported number of NA's in each column
colSums(is.na(Beer_Merge))

##Compare median ABV and IBU of each state.
ABV_Median <- as.data.frame(aggregate(Beer_Merge$ABV ~ Beer_Merge$State, Beer_Merge, median))
IBU_Median <- as.data.frame(aggregate(Beer_Merge$IBU ~ Beer_Merge$State, Beer_Merge, median))

Medians <- as.data.frame(merge(ABV_Median, IBU_Median, all = TRUE))
View(Medians)

##Plot bar charts to compare states to median ABV and IBU.

ABV_Plot <- ggplot(Medians, aes(x= reorder(Medians$`Beer_Merge$State`, -Medians$`Beer_Merge$ABV`), y= Medians$`Beer_Merge$ABV`, fill= Medians$`Beer_Merge$ABV`, colour = Medians$`Beer_Merge$State`)) + xlab("States") + ylab("ABV") + geom_bar(stat= "identity") + labs(colour = "State", fill = "ABV") + theme(axis.text.x= element_text(angle = 90, size = 7, hjust = 1)) + ggtitle("Median ABV By State") + coord_cartesian(ylim = c(0.00, 0.09)) + scale_fill_distiller(palette = "Spectral")

##IBU NA Data for SD
IBU_Plot <- ggplot(Medians, aes(x= reorder(Medians$`Beer_Merge$State`, -Medians$`Beer_Merge$IBU`), y= Medians$`Beer_Merge$IBU`, fill= Medians$`Beer_Merge$IBU`, colour = Medians$`Beer_Merge$State`)) + xlab("States") + ylab("IBU") + geom_bar(stat= "identity") + labs(colour = "State", fill = "IBU") + theme(axis.text.x= element_text(angle = 90, size = 7, hjust = 1)) + ggtitle("Median IBU By State") + coord_cartesian(ylim = c(00, 80)) + scale_fill_distiller(palette = "Spectral")

##Summary Statistics
summary(ABV_Median)
sd(ABV_Median$`Beer_Merge$ABV`)
range(ABV_Median$`Beer_Merge$ABV`)

Scatter_plot <- ggplot(Medians, aes(x = Medians$`Beer_Merge$ABV`, y= Medians$`Beer_Merge$IBU`, color = Medians$`Beer_Merge$State`)) + geom_point() + geom_smooth(method = "auto", se=TRUE, fullrange= TRUE, level= 0.95) + xlab("ABV") + ylab("IBU") + labs(colour = "States")


```

```{r}
#install.packages("pastecs")
library(pastecs)

stat.desc(ABV_Median$`Beer_Merge$ABV`)

stat.desc(ABV_Median$`Beer_Merge$ABV`, basic=TRUE, desc=TRUE, norm=TRUE, p=0.95)
```

```{r}



```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
